# Test Execution Verification - MANDATORY

**CRITICAL**: All tests MUST be executed with proof before marking any feature as production-ready.

## Golden Rule

```
ğŸš« "Tests written" â‰  "Tests executed"
âœ… DEMAND EXECUTION PROOF, NOT JUST CODE
ğŸ“Š SEPARATE REPORTING BY TEST TYPE
ğŸ” VERIFY INFRASTRUCTURE BEFORE TESTING
```

---

## The Critical Takeaway

**Shift from:**
- âŒ "Trust that subagents did their job"

**To:**
- âœ… "Verify with evidence that work was completed"

**"Code review" MUST include "test execution review"!**

---

## Why This Matters

### Real-World Impact: US1.1 Case Study

**What we claimed:**
- âœ… "39/39 tests passing (100%)"
- âœ… "Feature approved for production"

**What was actually true:**
- âœ… 39/39 **backend unit tests** passing
- âŒ 0/8 **E2E tests** executed (Playwright not installed)
- âš ï¸ E2E test **files** written, but **never ran**

**Result:** Feature marked production-ready with untested UI workflows.

---

## Mandatory Verification Process

### Phase 2: Integration Testing (QA Team)

**OLD Process (Insufficient):**
```
Engineer 2: E2E User Flow Tests
Tasks:
1. Write E2E test files âœ…
2. Document test scenarios âœ…
3. Create README with instructions âœ…

Result: Files exist â†’ Phase 2 "complete" âŒ
```

**NEW Process (Required):**
```
Engineer 2: E2E User Flow Tests
Tasks:
1. Write E2E test files âœ…
2. Verify test infrastructure:
   â–¡ Check: npm list @playwright/test
   â–¡ If missing: npm install -D @playwright/test
   â–¡ Install browsers: npx playwright install
   â–¡ Create config: playwright.config.ts
3. RUN TESTS: npx playwright test ğŸ”¥
4. Capture output/screenshots ğŸ”¥
5. Report: "X/Y tests passing" with proof ğŸ”¥
6. If failures: Debug OR report blockers
7. Commit: Test code + execution proof

ğŸš¨ GATE: Cannot proceed to Phase 3 without execution proof
```

---

## Required Evidence by Test Type

### 1. Backend Unit Tests

**Evidence Required:**
```bash
# Run tests
npm test

# Capture output showing:
âœ… Test Suites: 5 passed, 5 total
âœ… Tests:       39 passed, 39 total
âœ… Snapshots:   0 total
âœ… Time:        12.345 s
âœ… Coverage:    87.2% statements, 84.1% branches

# Save to file
npm test > test-results/backend-unit-output.txt
```

**Report Format:**
```
âœ… Backend Unit Tests: 39/39 passing (87% coverage)
ğŸ“„ Evidence: test-results/backend-unit-output.txt
```

---

### 2. E2E Tests (Browser-Based)

**Evidence Required:**
```bash
# Verify infrastructure
npm list @playwright/test
# If missing: npm install -D @playwright/test

# Install browsers
npx playwright install

# Create config if missing
# playwright.config.ts

# RUN TESTS
npx playwright test

# Capture output showing:
âœ… Running 8 tests using 1 worker
âœ… 8 passed (12s)

# Generate report
npx playwright show-report
```

**Report Format:**
```
âœ… E2E Tests: 8/8 passing
ğŸ“„ Evidence: playwright-report/index.html
ğŸ“¸ Screenshots: playwright-report/screenshots/
ğŸ¥ Videos: playwright-report/videos/
```

---

### 3. API Integration Tests

**Evidence Required:**
```bash
# Run integration tests with real backend
npm run test:integration

# Capture output showing:
âœ… API Integration Tests
âœ… POST /api/properties - Create property: PASS
âœ… GET /api/properties - List properties: PASS
âœ… GET /api/properties/:id - Get property: PASS
âœ… PUT /api/properties/:id - Update property: PASS
âœ… DELETE /api/properties/:id - Delete property: PASS
âœ… 12/12 integration tests passing
```

**Report Format:**
```
âœ… API Integration Tests: 12/12 passing
ğŸ“„ Evidence: test-results/api-integration-output.txt
```

---

## Phase 3: Review Verification

### OLD Review Process (Insufficient)

**QA Team Leader Review:**
```
âœ… Test Coverage: All acceptance criteria are testable
âœ… Test files exist for all user flows
âœ… README documents test execution steps

Approval: âœ… APPROVED FOR PRODUCTION
```

**Problem:** No verification that tests were **executed**.

---

### NEW Review Process (Required)

**QA Team Leader Review:**
```
ğŸ” TEST EXECUTION VERIFICATION:

Backend Tests:
â–¡ Test execution log provided?
â–¡ Pass/fail counts accurate?
â–¡ Coverage meets 80% threshold?
Evidence file: test-results/backend-unit-output.txt

E2E Tests:
â–¡ Test execution report provided?
â–¡ Infrastructure verified (Playwright installed)?
â–¡ All tests executed in real browser?
â–¡ Screenshots/videos captured?
Evidence file: playwright-report/index.html

API Tests:
â–¡ Test execution log provided?
â–¡ All endpoints tested?
â–¡ Real backend used (not mocked)?
Evidence file: test-results/api-integration-output.txt

ğŸš¨ REJECT IF:
âŒ Tests written but not executed
âŒ Test infrastructure missing
âŒ No execution proof provided
âŒ Execution logs not captured

âœ… APPROVE ONLY IF: All execution proof verified
```

---

## Separate Test Reporting

### âŒ BAD: Aggregate Numbers Hide Problems

```
ğŸ¯ 39/39 tests passing (100%)
```

**Problem:** Doesn't show which test types passed.

---

### âœ… GOOD: Separate Reporting by Type

```
ğŸ¯ Test Results Summary:
   Backend Unit Tests:    39/39 passing (100%) âœ…
   Backend Integration:   12/12 passing (100%) âœ…
   Frontend E2E:          8/8 passing (100%) âœ…
   Total:                 59/59 passing (100%) âœ…
   
ğŸ“Š Coverage:
   Backend: 87%
   Frontend: 92%
```

**Benefit:** Cannot hide untested E2E tests in aggregate numbers.

---

## Infrastructure Verification

### Pre-Flight Check (Before Writing Tests)

**Engineer 2 (E2E Tests) must run:**
```bash
#!/bin/bash
# E2E Infrastructure Check

echo "ğŸ” Verifying E2E test infrastructure..."

# Check Playwright
if ! npm list @playwright/test > /dev/null 2>&1; then
  echo "âš ï¸  Playwright not installed"
  echo "Installing: npm install -D @playwright/test"
  npm install -D @playwright/test
else
  echo "âœ… Playwright installed"
fi

# Check browsers
if [ ! -d "$HOME/Library/Caches/ms-playwright" ]; then
  echo "âš ï¸  Browsers not installed"
  echo "Installing: npx playwright install"
  npx playwright install
else
  echo "âœ… Browsers installed"
fi

# Check config
if [ ! -f "playwright.config.ts" ]; then
  echo "âš ï¸  Config not found - creating..."
  # Create default config
  cat > playwright.config.ts << 'EOF'
import { defineConfig } from '@playwright/test';

export default defineConfig({
  testDir: './test/e2e',
  fullyParallel: true,
  use: {
    baseURL: 'http://localhost:3000',
  },
});
EOF
  echo "âœ… Config created"
else
  echo "âœ… Config exists"
fi

echo "âœ… Infrastructure ready - proceeding with tests"
```

---

## Rejection Criteria

### Phase 2 Must Be Rejected If:

1. âŒ **Tests written but not executed**
   - Test files exist in codebase
   - No test execution output provided
   - No pass/fail counts

2. âŒ **Test infrastructure missing**
   - Playwright not installed
   - Browsers not installed
   - Config file missing

3. âŒ **No execution proof**
   - No test output logs
   - No screenshots/videos for E2E
   - No coverage reports

4. âŒ **Aggregate numbers hide gaps**
   - "39/39 tests passing" without breakdown
   - E2E tests not included in count
   - Only backend tests reported

5. âŒ **"Tests pass" without evidence**
   - Claims tests pass
   - No execution logs provided
   - No way to verify claim

---

## Phase Gate Enforcement

### Cannot Proceed to Phase 3 Without:

**Required Documents:**
- [ ] `test-results/backend-unit-output.txt`
- [ ] `playwright-report/index.html`
- [ ] `test-results/api-integration-output.txt`
- [ ] Separate pass/fail counts by test type
- [ ] Infrastructure verification checklist

**Required Verification:**
- [ ] All test files executed (not just written)
- [ ] All test infrastructure installed
- [ ] All execution logs captured
- [ ] All pass/fail counts accurate
- [ ] No hidden gaps in reporting

**If ANY missing â†’ BLOCK Phase 3**

---

## Implementation Checklist

### For QA Engineers (Phase 2):

**Before starting tests:**
- [ ] Verify test infrastructure installed
- [ ] Create infrastructure check script
- [ ] Document environment setup

**While writing tests:**
- [ ] Write test files
- [ ] Run tests continuously during development
- [ ] Capture execution output

**Before marking Phase 2 complete:**
- [ ] Run ALL tests one final time
- [ ] Capture all execution logs
- [ ] Generate test reports (HTML, JSON)
- [ ] Take screenshots/videos (E2E)
- [ ] Document pass/fail counts by type
- [ ] Commit execution proof files

**Phase 2 Deliverables:**
- [ ] Test code files
- [ ] Execution proof (logs, reports, screenshots)
- [ ] Separate test counts by type
- [ ] Infrastructure verification document

---

### For Team Leads (Phase 3 Review):

**Before approving Phase 3:**
- [ ] Verify test execution logs exist
- [ ] Check test infrastructure verified
- [ ] Verify pass/fail counts by type
- [ ] Review screenshots/videos (E2E)
- [ ] Confirm no aggregate hiding
- [ ] Demand proof if missing

**Approval Checklist:**
```
â–¡ Backend tests executed with proof
â–¡ E2E tests executed with proof
â–¡ API tests executed with proof
â–¡ All infrastructure verified
â–¡ Separate reporting by type
â–¡ No execution gaps found

âœ… APPROVED only if ALL checked
```

---

## Quick Reference

### Test Execution Commands

```bash
# Backend Unit Tests
npm test
npm test -- --coverage
npm test > test-results/backend-unit-output.txt

# E2E Tests (Playwright)
npx playwright test
npx playwright test --headed  # See browser
npx playwright test --ui      # Interactive UI
npx playwright show-report    # View HTML report

# E2E Tests (Cypress)
npx cypress run
npx cypress open  # Interactive mode

# API Integration Tests
npm run test:integration
npm run test:e2e
```

### Evidence Files to Commit

```
test-results/
â”œâ”€â”€ backend-unit-output.txt       # npm test output
â”œâ”€â”€ backend-coverage.json         # Coverage data
â”œâ”€â”€ api-integration-output.txt    # API test output
â””â”€â”€ playwright-report/
    â”œâ”€â”€ index.html                # E2E test report
    â”œâ”€â”€ screenshots/              # Test screenshots
    â””â”€â”€ videos/                   # Test videos
```

---

## Benefits

### For Quality:
- âœ… Catch integration issues before production
- âœ… Verify real user workflows work
- âœ… Build confidence in releases

### For Team:
- âœ… Clear evidence of testing
- âœ… No ambiguity about test status
- âœ… Professional verification process

### For Process:
- âœ… Prevents "tests written but not run" gaps
- âœ… Enforces proper verification gates
- âœ… Maintains production quality standards

---

## Summary

```
ğŸš« Tests written â‰  Tests executed
âœ… Demand execution proof
ğŸ“Š Separate reporting by type
ğŸ” Verify infrastructure first
ğŸš¨ Block Phase 3 without proof
ğŸ“ Commit execution evidence
```

**This rule ensures production quality by verifying tests were actually run, not just written!**

---

**Rule Status:** âœ… Active  
**Applies To:** ALL user stories and epics  
**Enforcement:** MANDATORY - Phase 3 cannot proceed without verification  
**Created:** February 3, 2026  
**Based On:** US1.1 lessons learned
